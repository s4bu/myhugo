<!DOCTYPE html>
<html lang="en"><head>
	<meta charset="utf-8">
	<meta name="description" content=''>
	<meta name="keywords" content=''>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href='https://www.vishalmishra.in/css/bootstrap.min.css'>
	<title>CTF: Cracking RSA Encryption</title>
	<nav class="navbar text-center sticky-top bg-white mt-2 mb-1">
		<a href='https://www.vishalmishra.in/'><span class="btn btn-sm btn-outline-primary">Home</span></a>
		<a href='https://www.vishalmishra.in/about'><span class="btn btn-sm btn-outline-secondary">About</span></a>
		<a href='https://www.vishalmishra.in/post'><span class="btn btn-sm btn-outline-success">Blog</span></a>
		<a href='https://www.vishalmishra.in/tags'><span class="btn btn-sm btn-outline-warning">Tags</span></a>
	</nav>
</head>
<body>
      <div id="content">


	<section class="container text-monospace text-justified mt-3">
	  <h2>CTF: Cracking RSA Encryption</h2>
	  <small class="text-secondary mb-5">Posted on May 7, 2018 | 1 minute read</small>
	  <p><h4 id="crypt-crack-poor-rsa"><strong>Crypt: Crack Poor RSA</strong></h4>
<p>**Challenge:**<br>
N = 58900433780152059829684181006276669633073820320761216330291745734792546625247<br>
C = 56191946659070299323432594589209132754159316947267240359739328886944131258862<br>
e = 65537<br>
Reverse encrypted text C to plain text</p>
<p>Below is my code to crack RSA with given N, C &amp; e. {works on py2+}</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> Crypto.PublicKey <span style="color:#f92672">import</span> RSA
<span style="color:#f92672">import</span> gmpy2

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">int2Text</span>(number, size):
    text <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>join([chr((number <span style="color:#f92672">&gt;&gt;</span> j) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>) <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> reversed(range(<span style="color:#ae81ff">0</span>, size <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>))])
    <span style="color:#66d9ef">return</span> text<span style="color:#f92672">.</span>lstrip(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>)

N <span style="color:#f92672">=</span> <span style="color:#ae81ff">58900433780152059829684181006276669633073820320761216330291745734792546625247</span>
C <span style="color:#f92672">=</span> <span style="color:#ae81ff">56191946659070299323432594589209132754159316947267240359739328886944131258862</span>
e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537L</span>
<span style="color:#75715e">#http://factordb.com/index.php?query=58900433780152059829684181006276669633073820320761216330291745734792546625247</span>

p <span style="color:#f92672">=</span> <span style="color:#ae81ff">176773485669509339371361332756951225661L</span>
q <span style="color:#f92672">=</span> <span style="color:#ae81ff">333197218785800427026869958933009188427L</span>
r<span style="color:#f92672">=</span>(p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
d <span style="color:#f92672">=</span> long(gmpy2<span style="color:#f92672">.</span>divm(<span style="color:#ae81ff">1</span>, e, r))

rsa <span style="color:#f92672">=</span> RSA<span style="color:#f92672">.</span>construct((N,e,d,p,q))
pt <span style="color:#f92672">=</span> rsa<span style="color:#f92672">.</span>decrypt(C)

<span style="color:#66d9ef">print</span> pt  <span style="color:#75715e"># returns 6872557977505747778161182217242712228364873860070580111494526546045</span>
<span style="color:#66d9ef">print</span> int2Text(pt,<span style="color:#ae81ff">100</span>) <span style="color:#75715e">#returns timctf{th0sE_rOoKIe_numB3rz}</span>


</code></pre></div><h5 id="references"><strong>References</strong>:</h5>
<ol>
<li><a href="https://contest.timisoaractf.com/challenges?category=crypto">timisoaractf</a></li>
</ol>
</p>
	  <code>tags:<span class='badge badge-dark'><a class='text-white' href='https://www.vishalmishra.in/tags/security%20testing'>Security Testing</a></span>
	  <span class='badge badge-dark'><a class='text-white' href='https://www.vishalmishra.in/tags/0-day'>0-day</a></span>
	  <span class='badge badge-dark'><a class='text-white' href='https://www.vishalmishra.in/tags/ctf'>CTF</a></span>
	  <span class='badge badge-dark'><a class='text-white' href='https://www.vishalmishra.in/tags/python'>Python</a></span>
	  
	  </code>
	  <div class="container mt-2" id="comments">
	    
		<small class="mt-1">Please mail your comments to <a href="vishal_mishra@live.com">vishal_mishra@live.com</a></small><br>
	    
	  </div>
	</section>



      </div>
  </body><footer>
  <div class="container-fluid bg-dark text-white text-monospace text-center mt-4">
    <small> | Powered by <a href="https://gohugo.io">Hugo</a></small>
  </div>
  
</footer>
</html>
