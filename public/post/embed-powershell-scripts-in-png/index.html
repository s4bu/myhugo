<!DOCTYPE html>
<html lang="en"><head>
	<meta charset="utf-8">
	<meta name="description" content=''>
	<meta name="keywords" content=''>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href='https://www.vishalmishra.in/css/bootstrap.min.css'>
	<title>Embed powershell scripts in the pixels of png</title>
	<nav class="navbar text-center sticky-top bg-white mt-2 mb-1">
		<a href='https://www.vishalmishra.in/'><span class="btn btn-sm btn-outline-primary">Home</span></a>
		<a href='https://www.vishalmishra.in/about'><span class="btn btn-sm btn-outline-secondary">About</span></a>
		<a href='https://www.vishalmishra.in/post'><span class="btn btn-sm btn-outline-success">Blog</span></a>
		<a href='https://www.vishalmishra.in/tags'><span class="btn btn-sm btn-outline-warning">Tags</span></a>
	</nav>
</head>
<body>
      <div id="content">


	<section class="container text-monospace text-justified mt-3">
	  <h2>Embed powershell scripts in the pixels of png</h2>
	  <small class="text-secondary mb-5">Posted on December 15, 2017 | 1 minute read</small>
	  <p><h2 id="attack">Attack</h2>
<p>Invoke-PSImage takes a PowerShell script and embeds the bytes of the script into the pixels of a PNG image. It generates a oneliner for executing either from file locally or from web.
This script can be very handy while targetting an memory attack, moving payloads &amp; compromising the system. Antivirus on which I tested failed to recognize the PNG as a malcious file.</p>
<p><img src="https://www.vishalmishra.in/media/antivirus-PS.PNG" alt=" Virus Total"></p>
<h2 id="exploit">Exploit</h2>
<p><strong>Malicious PNG Generation</strong></p>
<p><img src="https://www.vishalmishra.in/media/Invoke-PSImage.PNG" alt=" Invoke-PSImage"></p>
<h5 id="references"><strong>References</strong>:</h5>
<ol>
<li><a href="https://github.com/peewpw/Invoke-PSImage">GitHub</a></li>
</ol>
</p>
	  <code>tags:<span class='badge badge-dark'><a class='text-white' href='https://www.vishalmishra.in/tags/hack'>Hack</a></span>
	  <span class='badge badge-dark'><a class='text-white' href='https://www.vishalmishra.in/tags/powershell'>Powershell</a></span>
	  <span class='badge badge-dark'><a class='text-white' href='https://www.vishalmishra.in/tags/exploit'>Exploit</a></span>
	  
	  </code>
	  <div class="container mt-2" id="comments">
	    
		<small class="mt-1">Please mail your comments to <a href="vishal_mishra@live.com">vishal_mishra@live.com</a></small><br>
	    
	  </div>
	</section>



      </div>
  </body><footer>
  <div class="container-fluid bg-dark text-white text-monospace text-center mt-4">
    <small> | Powered by <a href="https://gohugo.io">Hugo</a></small>
  </div>
  
</footer>
</html>
